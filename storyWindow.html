<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href ="stylesheets/style.css">

    <title id="title"></title>

    <div class="options">
        <a button class="myButton">Auto type</a>
        <a button class="myButton">Close</a>
        <a button class="myButton">Mute</a>
    </div>

    <div class="main">
        <h1 id="chapterHeader"></h1>
        <p id="storyWindow"> <!--the writing will go in here --> </p>

        <div class="buttons">
            <a class="myButton">I am a button</a>
        </div>

    </div>

    <script>

        var storyWindow = document.getElementById("storyWindow");
        var filepath = sessionStorage.getItem("storyDirectory");
        var fs = require('fs'); // Load the File System to execute our common tasks (CRUD)

        //read and output
        fs.readFile(filepath, 'utf-8', (err, data) => {

            //error file
            if(err){
                alert("An error occurred reading the file :" + err.message);
                return;
            }

            //debug output
            console.log("The file content is: " + data);

            //iterators for key-press functionality
            var i=0;
            var splitted = data.split(/[\s]/);

            document.addEventListener('keydown', function(event) {
                if(i<splitted.length){

                    switch (splitted[i++]){

                        //Handle headings
                        case ('{HEADING}'):
                            var heading = splitted[i++];
                            console.log("this is before the while");
                            while (splitted[i] !== "{/HEADING}"){
                                console.log("this is in the while");
                                heading = heading + " " + splitted[i++];
                            }
                            document.getElementById("chapterHeader").innerText = heading;
                            break;

                        //Handle options
                        case "options":
                            //process options
                            break;

                        //Default words
                        default:
                            storyWindow.innerText = storyWindow.innerText + " " + splitted[i];
                            break;

                    }
                }
            });

        });

        function processElement(token) {

        }


    </script>

</head>
<body>

</body>
</html>